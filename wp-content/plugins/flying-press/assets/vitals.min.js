(()=>{var $=-1,m=t=>{addEventListener("pageshow",e=>{e.persisted&&($=e.timeStamp,t(e))},!0)},l=(t,e,i,n)=>{let r,s;return o=>{e.value>=0&&(o||n)&&(s=e.value-(r??0),(s||r===void 0)&&(r=e.value,e.delta=s,e.rating=((a,c)=>a>c[1]?"poor":a>c[0]?"needs-improvement":"good")(e.value,i),t(e)))}},I=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},F=()=>{let t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},v=()=>F()?.activationStart??0,h=(t,e=-1)=>{let i=F(),n="navigate";return $>=0?n="back-forward-cache":i&&(document.prerendering||v()>0?n="prerender":document.wasDiscarded?n="restore":i.type&&(n=i.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},C=new WeakMap;function M(t,e){return C.get(t)||C.set(t,new e),C.get(t)}var P=class{t;i=0;o=[];h(e){if(e.hadRecentInput)return;let i=this.o[0],n=this.o.at(-1);this.i&&i&&n&&e.startTime-n.startTime<1e3&&e.startTime-i.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}},f=(t,e,i={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){let n=new PerformanceObserver(r=>{Promise.resolve().then(()=>{e(r.getEntries())})});return n.observe({type:t,buffered:!0,...i}),n}}catch{}},A=t=>{let e=!1;return()=>{e||(t(),e=!0)}},u=-1,x=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,y=t=>{document.visibilityState==="hidden"&&u>-1&&(u=t.type==="visibilitychange"?t.timeStamp:0,X())},N=()=>{addEventListener("visibilitychange",y,!0),addEventListener("prerenderingchange",y,!0)},X=()=>{removeEventListener("visibilitychange",y,!0),removeEventListener("prerenderingchange",y,!0)},Q=()=>{if(u<0){let t=v();u=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(i=>i.name==="hidden"&&i.startTime>t)[0]?.startTime)??x(),N(),m(()=>{setTimeout(()=>{u=x(),N()})})}return{get firstHiddenTime(){return u}}},b=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},O=[1800,3e3],B=(t,e={})=>{b(()=>{let i=Q(),n,r=h("FCP"),s=f("paint",o=>{for(let a of o)a.name==="first-contentful-paint"&&(s.disconnect(),a.startTime<i.firstHiddenTime&&(r.value=Math.max(a.startTime-v(),0),r.entries.push(a),n(!0)))});s&&(n=l(t,r,O,e.reportAllChanges),m(o=>{r=h("FCP"),n=l(t,r,O,e.reportAllChanges),I(()=>{r.value=performance.now()-o.timeStamp,n(!0)})}))})},_=[.1,.25],J=(t,e={})=>{B(A(()=>{let i,n=h("CLS",0),r=M(e,P),s=a=>{for(let c of a)r.h(c);r.i>n.value&&(n.value=r.i,n.entries=r.o,i())},o=f("layout-shift",s);o&&(i=l(t,n,_,e.reportAllChanges),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(s(o.takeRecords()),i(!0))}),m(()=>{r.i=0,n=h("CLS",0),i=l(t,n,_,e.reportAllChanges),I(()=>i())}),setTimeout(i))}))},U=0,L=1/0,T=0,Y=t=>{for(let e of t)e.interactionId&&(L=Math.min(L,e.interactionId),T=Math.max(T,e.interactionId),U=T?(T-L)/7+1:0)},w,R=()=>w?U:performance.interactionCount??0,Z=()=>{"interactionCount"in performance||w||(w=f("event",Y,{type:"event",buffered:!0,durationThreshold:0}))},j=0,S=class{u=[];l=new Map;m;p;v(){j=R(),this.u.length=0,this.l.clear()}P(){let e=Math.min(this.u.length-1,Math.floor((R()-j)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;let i=this.u.at(-1),n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>i.T){if(n?e.duration>n.T?(n.entries=[e],n.T=e.duration):e.duration===n.T&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],T:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((r,s)=>s.T-r.T),this.u.length>10){let r=this.u.splice(10);for(let s of r)this.l.delete(s.id)}this.p?.(n)}}},W=t=>{let e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(e(t=A(t)),document.addEventListener("visibilitychange",t,{once:!0}))},D=[200,500],z=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&b(()=>{Z();let i,n=h("INP"),r=M(e,S),s=a=>{W(()=>{for(let d of a)r.h(d);let c=r.P();c&&c.T!==n.value&&(n.value=c.T,n.entries=c.entries,i())})},o=f("event",s,{durationThreshold:e.durationThreshold??40});i=l(t,n,D,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(s(o.takeRecords()),i(!0))}),m(()=>{r.v(),n=h("INP"),i=l(t,n,D,e.reportAllChanges)}))})},E=class{m;h(e){this.m?.(e)}},H=[2500,4e3],G=(t,e={})=>{b(()=>{let i=Q(),n,r=h("LCP"),s=M(e,E),o=c=>{e.reportAllChanges||(c=c.slice(-1));for(let d of c)s.h(d),d.startTime<i.firstHiddenTime&&(r.value=Math.max(d.startTime-v(),0),r.entries=[d],n())},a=f("largest-contentful-paint",o);if(a){n=l(t,r,H,e.reportAllChanges);let c=A(()=>{o(a.takeRecords()),a.disconnect(),n(!0)});for(let d of["keydown","click","visibilitychange"])addEventListener(d,()=>W(c),{capture:!0,once:!0});m(d=>{r=h("LCP"),n=l(t,r,H,e.reportAllChanges),I(()=>{r.value=performance.now()-d.timeStamp,n(!0)})})}})},q=[800,1800],k=t=>{document.prerendering?b(()=>k(t)):document.readyState!=="complete"?addEventListener("load",()=>k(t),!0):setTimeout(t)},K=(t,e={})=>{let i=h("TTFB"),n=l(t,i,q,e.reportAllChanges);k(()=>{let r=F();r&&(i.value=Math.max(r.responseStart-v(),0),i.entries=[r],n(!0),m(()=>{i=h("TTFB",0),n=l(t,i,q,e.reportAllChanges),n(!0)}))})};var ee=flying_press_vitals.site_id,{hostname:te,pathname:ne,searchParams:ie}=new URL(window.location.href),re=[...ie.keys()],se=navigator.connection?.effectiveType||"unknown",oe=performance.getEntriesByType("navigation")[0]?.type||"unknown",ae=navigator.userAgentData?.mobile??window.matchMedia("(pointer:coarse)").matches?"mobile":"desktop",p={},g=({name:t,value:e})=>{let i=t.toLowerCase();p[i]=i==="cls"?+e.toFixed(2):Math.round(e),Object.keys(p).length>=5&&V()};K(g);B(g);G(g);J(g);z(g);var V=()=>{if(!Object.keys(p).length)return;let t={...p,site_id:ee,domain:te,path:ne,query_keys:re,device:ae,connection:se,navigation:oe};Object.keys(p).forEach(i=>delete p[i]);let e=new Blob([JSON.stringify(t)],{type:"application/json"});navigator.sendBeacon("https://vitals.flyingpress.com",e)};addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&V()});})();
